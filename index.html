<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TekLab Techno Winnovation</title>
  <!--
    Single-file interactive presentation for the Techno Winnovation session.
    - Uses CSS variables to easily tweak colors/spacing.
    - No external assets or dependencies required.
  -->
  <style>
    :root {
      --bg: #003d5b;
      --bg-soft: rgba(37, 226, 204, 0.08);
      --card: rgba(0, 61, 91, 0.55);
      --border: rgba(37, 226, 204, 0.28);
      --text: #eaf6fb;
      --muted: #b1d3da;
      --primary: #25e2cc;
      --secondary: #0f6b8c;
      --accent: #4cf0dc;
      --shadow: 0 20px 50px rgba(0, 0, 0, 0.55);
      --radius: 18px;
      --spacing: 18px;
      --transition-fast: 240ms ease;
      --transition-slow: 520ms ease;
    }

    html {
      scroll-behavior: smooth;
    }

    .org-flow {
      display: grid;
      gap: 14px;
    }

    .org-stepper {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items: center;
    }

    .org-step-btn {
      background: rgba(255, 255, 255, 0.06);
      border: 1px solid rgba(37, 226, 204, 0.35);
      color: var(--org-text-soft);
      padding: 8px 14px;
      border-radius: var(--org-radius-pill);
      cursor: pointer;
      transition: background var(--transition-fast), border var(--transition-fast), color var(--transition-fast);
      font-weight: 700;
      letter-spacing: 0.04em;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .org-step-btn .org-step-index {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 22px;
      height: 22px;
      border-radius: 999px;
      background: linear-gradient(135deg, var(--org-accent-teal), var(--org-accent-pink));
      color: #003d5b;
      font-size: 12px;
      font-weight: 800;
    }

    .org-step-btn.active,
    .org-step-btn:hover {
      color: var(--org-text-main);
      border-color: rgba(37, 226, 204, 0.55);
      background: radial-gradient(circle at top left, rgba(56, 189, 248, 0.14), rgba(255, 79, 163, 0.08));
      box-shadow: 0 10px 22px rgba(14, 165, 233, 0.2);
    }

    .org-flow-controls {
      display: flex;
      align-items: center;
      gap: 12px;
      justify-content: space-between;
      background: rgba(255, 255, 255, 0.04);
      border: 1px solid rgba(37, 226, 204, 0.25);
      padding: 12px 14px;
      border-radius: var(--org-radius-pill);
      position: sticky;
      bottom: 0;
      backdrop-filter: blur(8px);
    }

    .org-flow-actions {
      display: flex;
      gap: 8px;
    }

    .org-flow-controls button {
      border-radius: var(--org-radius-pill);
      background: linear-gradient(135deg, rgba(56, 189, 248, 0.14), rgba(255, 79, 163, 0.12));
      border: 1px solid rgba(37, 226, 204, 0.5);
      color: var(--org-text-main);
      padding: 8px 14px;
      cursor: pointer;
      transition: opacity var(--transition-fast), transform var(--transition-fast);
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-weight: 700;
    }

    .org-flow-controls button:disabled {
      opacity: 0.35;
      cursor: not-allowed;
    }

    .org-flow-controls button:hover:not(:disabled) {
      transform: translateY(-1px);
    }

    .org-step-counter {
      color: var(--org-text-muted);
      font-size: 12px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }

    .modal-backdrop {
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      background: rgba(2, 8, 22, 0.82);
      backdrop-filter: blur(8px);
      z-index: 999;
      padding: 16px;
    }

    .modal-backdrop.open {
      display: flex;
    }

    .modal-surface {
      position: relative;
      width: min(1280px, 95vw);
      height: min(900px, 92vh);
      background: radial-gradient(circle at top left, rgba(37, 226, 204, 0.12), rgba(15, 107, 140, 0.1)),
        rgba(0, 45, 73, 0.96);
      border-radius: 22px;
      border: 1px solid rgba(37, 226, 204, 0.35);
      box-shadow: 0 24px 70px rgba(0, 0, 0, 0.55);
      overflow: hidden;
      display: grid;
      grid-template-rows: auto 1fr;
    }

    .modal-toolbar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 14px;
      gap: 12px;
      background: rgba(0, 61, 91, 0.85);
      border-bottom: 1px solid rgba(37, 226, 204, 0.25);
    }

    .modal-title {
      margin: 0;
      font-size: 15px;
      letter-spacing: 0.04em;
      color: var(--text);
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .modal-title span {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 24px;
      height: 24px;
      border-radius: 999px;
      background: linear-gradient(135deg, var(--primary), var(--accent));
      color: #003d5b;
      font-weight: 800;
      font-size: 12px;
    }

    .modal-close {
      border: 1px solid rgba(37, 226, 204, 0.45);
      background: linear-gradient(135deg, rgba(37, 226, 204, 0.15), rgba(110, 240, 255, 0.12));
      color: var(--text);
      border-radius: 999px;
      padding: 8px 12px;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-weight: 700;
      cursor: pointer;
      transition: transform var(--transition-fast), opacity var(--transition-fast);
    }

    .modal-close:hover {
      transform: translateY(-1px);
    }

    .modal-frame {
      width: 100%;
      height: 100%;
      border: none;
      border-radius: 0 0 22px 22px;
      background: #022c42;
    }

    .org-step-panels {
      position: relative;
      overflow: hidden;
      min-height: 520px;
      display: grid;
    }

    .org-step {
      display: none;
      gap: 14px;
      animation: fadeIn 200ms ease-in;
    }

    .org-step.active {
      display: grid;
    }

    .reorder-panel {
      background: rgba(255, 255, 255, 0.06);
      border: 1px solid rgba(37, 226, 204, 0.25);
      border-radius: var(--radius);
      padding: calc(var(--spacing) * 0.9);
      box-shadow: var(--shadow);
      margin: 0 calc(var(--spacing) * 1.3) calc(var(--spacing) * 1.2);
      display: grid;
      gap: 10px;
    }

    .reorder-header {
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      gap: 12px;
      flex-wrap: wrap;
    }

    .reorder-header h2 {
      margin: 0;
      font-size: 18px;
      letter-spacing: 0.04em;
    }

    .reorder-subtitle {
      margin: 0;
      color: var(--muted);
      font-size: 14px;
    }

    .reorder-list {
      list-style: none;
      padding: 0;
      margin: 0;
      display: grid;
      gap: 8px;
    }

    .reorder-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 12px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px dashed rgba(37, 226, 204, 0.35);
      border-radius: var(--radius);
      cursor: grab;
      transition: background var(--transition-fast), border var(--transition-fast), transform var(--transition-fast);
      user-select: none;
    }

    .reorder-item:focus-visible {
      outline: 2px solid var(--primary);
      outline-offset: 4px;
    }

    .reorder-item.dragging {
      opacity: 0.8;
      border-style: solid;
      background: rgba(110, 240, 255, 0.08);
      transform: scale(1.01);
    }

    .reorder-item:hover {
      background: rgba(255, 255, 255, 0.08);
      border-color: rgba(37, 226, 204, 0.55);
    }

    .reorder-handle {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 32px;
      height: 32px;
      border-radius: 10px;
      background: rgba(255, 255, 255, 0.08);
      color: var(--primary);
      font-weight: 800;
      font-size: 16px;
    }

    .reorder-label {
      font-weight: 700;
      letter-spacing: 0.02em;
    }

    .reorder-badge {
      margin-left: auto;
      background: linear-gradient(135deg, rgba(37, 226, 204, 0.2), rgba(15, 107, 140, 0.24));
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid rgba(37, 226, 204, 0.35);
      font-size: 12px;
      color: var(--text);
      letter-spacing: 0.05em;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(8px); }
      to { opacity: 1; transform: translateY(0); }
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: "Segoe UI", "Roboto", "Helvetica Neue", Arial, sans-serif;
      background: radial-gradient(circle at 20% 20%, rgba(37, 226, 204, 0.18), transparent 30%),
                  radial-gradient(circle at 80% 10%, rgba(0, 61, 91, 0.32), transparent 36%),
                  radial-gradient(circle at 50% 80%, rgba(15, 107, 140, 0.22), transparent 42%),
                  var(--bg);
      color: var(--text);
      overflow-y: auto;
    }

    /* Top navigation bar */
    .top-nav {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 64px;
      display: flex;
      align-items: center;
      padding: 0 calc(var(--spacing) * 1.5);
      background: linear-gradient(90deg, rgba(0, 61, 91, 0.9), rgba(0, 61, 91, 0.75));
      border-bottom: 1px solid var(--border);
      backdrop-filter: blur(10px);
      z-index: 10;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 12px;
      font-weight: 700;
      letter-spacing: 0.6px;
    }

    .brand .dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      box-shadow: 0 0 12px rgba(110, 240, 255, 0.6);
    }

    .nav-links {
      display: flex;
      gap: 10px;
      margin-left: auto;
    }

    .nav-links button {
      background: transparent;
      border: 1px solid transparent;
      color: var(--muted);
      padding: 10px 14px;
      border-radius: 999px;
      cursor: pointer;
      transition: color var(--transition-fast), background var(--transition-fast), border var(--transition-fast);
      font-weight: 600;
    }

    .nav-links button.active,
    .nav-links button:hover {
      color: var(--text);
      border-color: var(--border);
      background: rgba(255, 255, 255, 0.06);
    }

    .cta-button {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 12px 16px;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: linear-gradient(135deg, rgba(110, 240, 255, 0.18), rgba(255, 110, 199, 0.14));
      color: var(--text);
      text-decoration: none;
      font-weight: 700;
      letter-spacing: 0.02em;
      transition: transform var(--transition-fast), box-shadow var(--transition-fast), border-color var(--transition-fast);
      width: fit-content;
    }

    .cta-button:hover {
      transform: translateY(-1px);
      border-color: rgba(37, 226, 204, 0.55);
      box-shadow: 0 12px 28px rgba(0, 0, 0, 0.35);
    }

    /* Layout container for slides */
    .viewport {
      position: relative;
      padding-top: 64px;
      min-height: 100vh;
    }

    /* Scoped styles for the Organization COE org chart */
    .org-scope {
      --org-bg: #022c42;
      --org-card: #0a3c55;
      --org-accent-teal: #25e2cc;
      --org-accent-pink: #0f6b8c;
      --org-accent-border: #0d4f6a;
      --org-text-main: #f9fafb;
      --org-text-soft: #cbd5f5;
      --org-text-muted: #8b9ac5;
      --org-line: #0f4f6b;
      --org-radius-lg: 18px;
      --org-radius-pill: 999px;
      --org-shadow-soft: 0 18px 40px rgba(15, 23, 42, 0.75);

      position: relative;
      background: radial-gradient(circle at top left, #0b4f6b 0, var(--org-bg) 55%),
        radial-gradient(circle at bottom right, #012f46 0, #001724 70%);
      color: var(--org-text-main);
      border-radius: 24px;
      padding: 20px;
      border: 1px solid rgba(37, 226, 204, 0.25);
      box-shadow: var(--org-shadow-soft);
      overflow: hidden;
    }

    .org-scope::before {
      content: "";
      position: absolute;
      inset: -120px;
      background:
        radial-gradient(circle at top right, rgba(37, 226, 204, 0.12), transparent 55%),
        radial-gradient(circle at bottom left, rgba(15, 107, 140, 0.12), transparent 55%);
      pointer-events: none;
    }

    .org-wrapper {
      position: relative;
      z-index: 1;
      max-width: 1320px;
      margin: 0 auto;
      display: grid;
      gap: 18px;
    }

    .org-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 16px;
    }

    .org-title-block {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .org-eyebrow {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 4px 12px;
      border-radius: var(--org-radius-pill);
      border: 1px solid rgba(37, 226, 204, 0.5);
      background: radial-gradient(circle at top left, rgba(56, 189, 248, 0.3), transparent 70%);
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--org-text-soft);
      width: fit-content;
    }

    .org-eyebrow-dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: linear-gradient(135deg, var(--org-accent-teal), var(--org-accent-pink));
    }

    .org-title-block h3 {
      font-size: 20px;
      letter-spacing: 0.03em;
      text-transform: uppercase;
      margin: 0;
    }

    .org-subtitle {
      font-size: 13px;
      color: var(--org-text-muted);
      max-width: 580px;
      margin: 0;
      line-height: 1.5;
    }

    .org-top-right {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 10px;
    }

    .org-legend {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
      justify-content: flex-end;
      font-size: 11px;
      color: var(--org-text-muted);
    }

    .org-legend-item {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      border-radius: var(--org-radius-pill);
      background: rgba(15, 23, 42, 0.85);
      border: 1px solid rgba(51, 65, 85, 0.9);
    }

    .org-legend-pill {
      width: 20px;
      height: 10px;
      border-radius: 999px;
    }

    .pill-backbone { background: linear-gradient(135deg, #0f6b8c, #25e2cc); }
    .pill-france { background: linear-gradient(135deg, #003d5b, #25e2cc); }
    .pill-maghreb { background: linear-gradient(135deg, #0b4f6b, #4cf0dc); }

    .org-lang-toggle {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 3px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(37, 226, 204, 0.4);
      font-size: 12px;
    }

    .org-lang-btn {
      border: none;
      outline: none;
      background: transparent;
      color: var(--org-text-soft);
      padding: 4px 10px;
      border-radius: 999px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
      font-size: 12px;
    }

    .org-lang-btn span.flag {
      font-size: 14px;
    }

    .org-lang-btn.active {
      background: radial-gradient(circle at top, rgba(59, 130, 246, 0.35), rgba(15, 23, 42, 0.95));
      color: var(--org-text-main);
      border: 1px solid rgba(129, 140, 248, 0.8);
    }

    .org-lang-btn:not(.active) {
      border: 1px solid transparent;
    }

    .org-grid {
      display: grid;
      grid-template-columns: 1.3fr 1.2fr;
      gap: 16px 18px;
    }

    .org-card {
      background: radial-gradient(circle at top left, rgba(15, 118, 110, 0.18), rgba(15, 23, 42, 0.96));
      border-radius: var(--org-radius-lg);
      border: 1px solid var(--org-accent-border);
      padding: 14px 16px 14px;
      position: relative;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.35);
    }

    .org-card.card-backbone {
      grid-column: 1 / 3;
      background: radial-gradient(circle at top left, rgba(37, 226, 204, 0.2), rgba(0, 45, 73, 0.98));
    }

    .org-card.card-france {
      background: radial-gradient(circle at top left, rgba(15, 107, 140, 0.2), rgba(0, 45, 73, 0.98));
    }

    .org-card.card-maghreb {
      background: radial-gradient(circle at top left, rgba(0, 61, 91, 0.25), rgba(0, 45, 73, 0.98));
    }

    .org-card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      margin-bottom: 10px;
    }

    .org-card-title {
      font-size: 13px;
      font-weight: 600;
      letter-spacing: 0.06em;
      text-transform: uppercase;
    }

    .org-tag {
      font-size: 10px;
      padding: 3px 10px;
      border-radius: var(--org-radius-pill);
      border: 1px solid rgba(37, 226, 204, 0.7);
      background: rgba(0, 61, 91, 0.85);
      color: var(--org-text-soft);
      text-transform: uppercase;
      letter-spacing: 0.08em;
      white-space: nowrap;
    }

    .org-tag.tag-backbone { border-color: rgba(37, 226, 204, 0.85); }
    .org-tag.tag-france { border-color: rgba(15, 107, 140, 0.85); }
    .org-tag.tag-maghreb { border-color: rgba(0, 61, 91, 0.85); }

    .org-card-body {
      font-size: 12px;
      color: var(--org-text-soft);
      display: grid;
      gap: 8px;
    }

    .org-line-title {
      font-size: 12px;
      font-weight: 600;
      color: var(--org-text-main);
    }

    .org-sub-block {
      padding: 8px 10px;
      border-radius: 12px;
      background: rgba(15, 23, 42, 0.95);
      border: 1px solid rgba(55, 65, 81, 0.9);
      display: grid;
      gap: 4px;
    }

    .org-sub-label {
      font-size: 11px;
      color: var(--org-text-muted);
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }

    .org-kpi-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 3px;
    }

    .org-kpi {
      min-width: 90px;
      padding: 4px 8px;
      border-radius: 10px;
      background: rgba(15, 23, 42, 0.96);
      border: 1px solid rgba(75, 85, 99, 0.85);
      display: grid;
      gap: 1px;
    }

    .org-kpi-label {
      font-size: 10px;
      color: var(--org-text-muted);
      text-transform: uppercase;
      letter-spacing: 0.06em;
    }

    .org-kpi-value {
      font-size: 12px;
      font-weight: 600;
    }

    .org-divider-label {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: var(--org-text-muted);
      margin: 10px 2px 4px;
    }

    .org-local-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 8px 10px;
      margin-top: 4px;
    }

    .org-local-col {
      display: grid;
      gap: 6px;
    }

    .org-local-title {
      font-size: 11px;
      font-weight: 600;
      color: var(--org-text-main);
    }

    .org-local-item {
      display: grid;
      gap: 2px;
      padding: 6px 8px;
      border-radius: 12px;
      background: rgba(15, 23, 42, 0.95);
      border: 1px solid rgba(75, 85, 99, 0.9);
    }

    .org-local-role {
      font-size: 11px;
      color: var(--org-text-soft);
    }

    .org-local-n1 {
      font-size: 10px;
      color: var(--org-text-muted);
    }

    .org-badge-open {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      margin-top: 2px;
      font-size: 10px;
      color: #e6fbf7;
      background: rgba(37, 226, 204, 0.18);
      border-radius: 999px;
      padding: 2px 8px;
      border: 1px solid rgba(37, 226, 204, 0.55);
      width: fit-content;
    }

    .org-badge-open-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: #25e2cc;
    }

    .org-connector-row {
      position: relative;
      margin: 4px 0 2px;
      height: 18px;
    }

    .org-connector-row::before {
      content: "";
      position: absolute;
      left: 8%;
      right: 8%;
      top: 50%;
      height: 1px;
      background: linear-gradient(to right, transparent, var(--org-line), transparent);
      opacity: 0.9;
    }

    .org-connector-label {
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      padding: 2px 10px;
      border-radius: var(--org-radius-pill);
      border: 1px solid rgba(37, 226, 204, 0.55);
      background: radial-gradient(circle at top, rgba(15, 23, 42, 0.96), rgba(15, 23, 42, 0.98));
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: var(--org-text-soft);
      text-align: center;
      max-width: 90%;
    }

    @media (max-width: 1024px) {
      .org-grid { grid-template-columns: 1fr; }
      .org-card.card-backbone { grid-column: 1 / 2; }
      .org-local-grid { grid-template-columns: 1fr; }
      .org-header { flex-direction: column; }
      .org-top-right { align-items: flex-start; }
    }

    @media (max-width: 768px) {
      .org-scope { padding: 16px; border-radius: 18px; }
      .org-title-block h3 { font-size: 18px; }
      .org-subtitle { font-size: 12px; }
    }

    .slides {
      position: relative;
      width: 100%;
      height: auto;
      display: flex;
      flex-direction: column;
      gap: calc(var(--spacing) * 2);
      scroll-snap-type: y mandatory;
    }

    .slide {
      width: 100%;
      min-height: calc(100vh - 64px);
      padding: calc(var(--spacing) * 2) calc(var(--spacing) * 2.5);
      display: grid;
      grid-template-rows: auto 1fr;
      gap: calc(var(--spacing) * 1.5);
      scroll-snap-align: start;
      scroll-margin-top: 72px;
    }

    /* Slide header */
    .section-title {
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 22px;
      letter-spacing: 0.4px;
      text-transform: uppercase;
    }

    .section-title span {
      padding: 6px 12px;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: rgba(255, 255, 255, 0.05);
      color: var(--primary);
      font-weight: 700;
    }

    /* Content cards */
    .content-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: var(--spacing);
      align-content: start;
    }

    .card {
      padding: calc(var(--spacing) * 1.2);
      border-radius: var(--radius);
      background: linear-gradient(145deg, var(--card), rgba(255, 255, 255, 0.04));
      border: 1px solid var(--border);
      box-shadow: var(--shadow);
      backdrop-filter: blur(8px);
      position: relative;
      overflow: hidden;
    }

    .card::after {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 20% 20%, rgba(110, 240, 255, 0.08), transparent 35%);
      opacity: 0;
      transition: opacity var(--transition-fast);
      pointer-events: none;
    }

    .card:hover::after { opacity: 1; }

    .card h3 {
      margin: 0 0 6px;
      font-size: 18px;
      color: var(--primary);
    }

    .card p {
      margin: 4px 0 0;
      color: var(--muted);
      line-height: 1.5;
    }

    .pillars {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: var(--spacing);
    }

    .kpi {
      background: rgba(255, 255, 255, 0.04);
      border-radius: 12px;
      padding: 12px 14px;
      border: 1px solid var(--border);
    }

    .kpi .bar {
      height: 8px;
      border-radius: 8px;
      background: linear-gradient(90deg, var(--secondary), var(--primary));
      margin-top: 10px;
      width: var(--value, 60%);
      box-shadow: 0 0 12px rgba(110, 240, 255, 0.5);
    }

    /* Responsive tweaks */
    @media (max-width: 900px) {
      .top-nav { height: 58px; padding: 0 var(--spacing); }
      .viewport { padding-top: 58px; }
      .nav-links { gap: 4px; }
      .nav-links button { padding: 8px 10px; font-size: 13px; }
      .slide { padding: calc(var(--spacing) * 1.5); }
    }

    @media (max-width: 640px) {
      .top-nav { position: fixed; }
      .nav-links { display: none; }
      .section-title { font-size: 18px; }
      .card { font-size: 14px; }
    }
  </style>
</head>
<body>
  <header class="top-nav">
    <div class="brand">
      <div class="dot"></div>
      <div>TekLab | Techno Winnovation</div>
    </div>
    <!-- Top navigation buttons are injected by JavaScript for easy updates. -->
    <div class="nav-links" id="topNav"></div>
  </header>

  <main class="viewport">
    <section class="reorder-panel" aria-label="Reorder presentation sections">
      <div class="reorder-header">
        <h2>Arrange the journey</h2>
        <p class="reorder-subtitle">Drag and drop to change the order of the focus areas.</p>
      </div>
      <ol class="reorder-list" id="reorderList"></ol>
    </section>
    <!--
      The slides container translates along the Y axis to show one slide at a time.
      Each .slide section represents a full-screen area.
    -->
    <div class="slides" id="slides">
      <section class="slide" data-title="A. COE">
        <div class="section-title"><span>A</span>COE (Center of Excellence)</div>
        <div class="content-grid">
          <div class="card">
            <h3>Intro</h3>
            <p>High-level introduction about the Center of Excellence and its positioning within Concentrix TekLab.</p>
          </div>
          <div class="card">
            <h3>Purpose & Scope</h3>
            <p>TODO: Describe core purpose, scope, and charter for the COE.</p>
          </div>
          <div class="card">
            <h3>Governance</h3>
            <p>TODO: Outline governance model, decision cadence, and stakeholder alignment.</p>
          </div>
        </div>
      </section>

      <section class="slide" data-title="B. Organization COE">
        <div class="section-title"><span>B</span>Organization COE</div>
        <div class="org-scope" aria-label="COE Organization chart for France &amp; Maghreb">
          <div class="org-wrapper">
            <header class="org-header">
              <div class="org-title-block">
                <div class="org-eyebrow">
                  <span class="org-eyebrow-dot"></span>
                  <span class="org-i18n"
                    data-en="COE ORGANIZATION ‚Äì FRANCE &amp; MAGHREB"
                    data-fr="ORGANISATION DES COE ‚Äì FRANCE &amp; MAGHREB">
                    COE ORGANIZATION ‚Äì FRANCE &amp; MAGHREB
                  </span>
                </div>
                <h3 class="org-i18n"
                  data-en="Regional COE Org Chart ‚Äì TekLab View"
                  data-fr="Sch√©ma d‚Äôorganisation COE ‚Äì Vue TekLab">
                  Regional COE Org Chart ‚Äì TekLab View
                </h3>
                <p class="org-subtitle org-i18n"
                  data-en="Final integrated organization chart for the regional transformation backbone, France COE (N2 BTM) and Maghreb COE (Chefs de Projet Innovation &amp; N1 consultants)."
                  data-fr="Sch√©ma final int√©grant le socle de transformation r√©gionale, le COE France (BTM N2) et le COE Maghreb (Chefs de Projet Innovation &amp; consultants N1).">
                  Final integrated organization chart for the regional transformation backbone, France COE (N2 BTM) and Maghreb COE (Chefs de Projet Innovation &amp; N1 consultants).
                </p>
              </div>

              <div class="org-top-right">
                <div class="org-lang-toggle" aria-label="Language toggle">
                  <button class="org-lang-btn active" data-lang="en" type="button">
                    <span class="flag">üá¨üáß</span>
                    <span>EN</span>
                  </button>
                  <button class="org-lang-btn" data-lang="fr" type="button">
                    <span class="flag">üá´üá∑</span>
                    <span>FR</span>
                  </button>
                </div>

                <div class="org-legend">
                  <div class="org-legend-item">
                    <span class="org-legend-pill pill-backbone"></span>
                    <span class="org-i18n"
                      data-en="Regional backbone"
                      data-fr="Socle r√©gional">
                      Regional backbone
                    </span>
                  </div>
                  <div class="org-legend-item">
                    <span class="org-legend-pill pill-france"></span>
                    <span class="org-i18n"
                      data-en="France COE (N2)"
                      data-fr="COE France (N2)">
                      France COE (N2)
                    </span>
                  </div>
                  <div class="org-legend-item">
                    <span class="org-legend-pill pill-maghreb"></span>
                    <span class="org-i18n"
                      data-en="Maghreb COE (N1)"
                      data-fr="COE Maghreb (N1)">
                      Maghreb COE (N1)
                    </span>
                  </div>
                </div>
              </div>
            </header>



        <div class="org-flow">
          <div class="org-stepper" role="tablist" aria-label="Organization journey">
            <button class="org-step-btn active" data-step="0" type="button" role="tab" aria-selected="true">
              <span class="org-step-index">1</span>
              <span class="org-i18n" data-en="Regional Backbone" data-fr="Socle r√©gional">Regional Backbone</span>
            </button>
            <button class="org-step-btn" data-step="1" type="button" role="tab" aria-selected="false">
              <span class="org-step-index">2</span>
              <span class="org-i18n" data-en="France COE" data-fr="COE France">France COE</span>
            </button>
            <button class="org-step-btn" data-step="2" type="button" role="tab" aria-selected="false">
              <span class="org-step-index">3</span>
              <span class="org-i18n" data-en="Maghreb COE" data-fr="COE Maghreb">Maghreb COE</span>
            </button>
          </div>

          <div class="org-step-panels">
            <div class="org-step active" data-step="0" role="tabpanel">
              <div class="org-grid">
                <section class="org-card card-backbone">
                  <div class="org-card-header">
                    <div class="org-card-title org-i18n"
                      data-en="Regional Transformation Backbone"
                      data-fr="Socle de transformation r√©gionale">
                      Regional Transformation Backbone
                    </div>
                    <span class="org-tag tag-backbone org-i18n"
                      data-en="Overall transformation"
                      data-fr="Transformation globale">
                      Overall transformation
                    </span>
                  </div>
                  <div class="org-card-body">
                    <div class="org-sub-block">
                      <div class="org-sub-label org-i18n"
                        data-en="Overall Transformation"
                        data-fr="Transformation globale">
                        Overall Transformation
                      </div>
                      <div class="org-line-title org-i18n"
                        data-en="Edouard Coumert"
                        data-fr="Edouard Coumert">
                        Edouard Coumert
                      </div>
                      <p class="org-i18n"
                        data-en="Provides overall leadership for the regional transformation agenda across France &amp; Maghreb."
                        data-fr="Porte le leadership global de l‚Äôagenda de transformation sur la France &amp; le Maghreb.">
                        Provides overall leadership for the regional transformation agenda across France &amp; Maghreb.
                      </p>
                    </div>

                    <div class="org-sub-block">
                      <div class="org-sub-label org-i18n"
                        data-en="Shared Service ‚Äì Set-up &amp; Continuous Improvement"
                        data-fr="Shared Service ‚Äì Set-up &amp; am√©lioration continue">
                        Shared Service ‚Äì Set-up &amp; Continuous Improvement
                      </div>
                      <div class="org-line-title org-i18n"
                        data-en="Shared Service Lead: Naoual El Idrissi"
                        data-fr="Shared Service Lead&nbsp;: Naoual El Idrissi">
                        Shared Service Lead: Naoual El Idrissi
                      </div>
                      <div class="org-kpi-row">
                        <div class="org-kpi">
                          <div class="org-kpi-label org-i18n" data-en="PMO" data-fr="PMO">PMO</div>
                          <div class="org-kpi-value org-i18n" data-en="~5 FTE" data-fr="~5 ETP">~5 FTE</div>
                          <div class="org-kpi-label org-i18n" data-en="Scope" data-fr="P√©rim√®tre">Scope</div>
                          <div class="org-kpi-value org-i18n" data-en="France + Maghreb (+ WAF / IO)" data-fr="France + Maghreb (+ WAF / IO)">
                            France + Maghreb (+ WAF / IO)
                          </div>
                        </div>
                        <div class="org-kpi">
                          <div class="org-kpi-label org-i18n" data-en="N2 Experts" data-fr="Experts N2">N2 Experts</div>
                          <div class="org-kpi-value org-i18n" data-en="~12 roles" data-fr="~12 r√¥les">~12 roles</div>
                          <div class="org-kpi-label org-i18n" data-en="Focus" data-fr="Focus">Focus</div>
                          <div class="org-kpi-value org-i18n"
                            data-en="Set-up, tuning, QA, agent support"
                            data-fr="Set-up, tuning, QA, support agent">
                            Set-up, tuning, QA, agent support
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="org-sub-block">
                      <div class="org-sub-label org-i18n"
                        data-en="Functional Core ‚Äì Regional Transformation"
                        data-fr="P√¥le fonctionnel ‚Äì Transformation r√©gionale">
                        Functional Core ‚Äì Regional Transformation
                      </div>
                      <div class="org-line-title org-i18n"
                        data-en="Tiburce de C√©zac (20%)"
                        data-fr="Tiburce de C√©zac (20&nbsp;%)">
                        Tiburce de C√©zac (20%)
                      </div>
                      <p class="org-i18n"
                        data-en="Owns functional standards and ensures alignment of BU &amp; PresalesTech with the transformation agenda."
                        data-fr="Porte les standards fonctionnels et aligne BU &amp; PresalesTech sur l‚Äôagenda de transformation.">
                        Owns functional standards and ensures alignment of BU &amp; PresalesTech with the transformation agenda.
                      </p>
                    </div>

                    <div class="org-sub-block">
                      <div class="org-sub-label org-i18n"
                        data-en="Regional Delivery Drive"
                        data-fr="Pilotage r√©gional du delivery">
                        Regional Delivery Drive
                      </div>
                      <p class="org-i18n"
                        data-en="Coordinates prioritisation, deployment roadmap and consolidated risks across France, Maghreb and other regions."
                        data-fr="Coordonne la priorisation, la feuille de route de d√©ploiement et la vision consolid√©e des risques sur la France, le Maghreb et les autres r√©gions.">
                        Coordinates prioritisation, deployment roadmap and consolidated risks across France, Maghreb and other regions.
                      </p>
                    </div>
                  </div>
                </section>
              </div>
            </div>

            <div class="org-step" data-step="1" role="tabpanel">
              <div class="org-grid">
                <section class="org-card card-france">
                  <div class="org-card-header">
                    <div class="org-card-title org-i18n"
                      data-en="France COE ‚Äì N2 Technical Consultants"
                      data-fr="COE France ‚Äì Consultants techniques N2">
                      France COE ‚Äì N2 Technical Consultants
                    </div>
                    <span class="org-tag tag-france org-i18n"
                      data-en="COE France (N2 BTM)"
                      data-fr="COE France (BTM N2)">
                      COE France (N2 BTM)
                    </span>
                  </div>
                  <div class="org-card-body">
                    <p class="org-i18n"
                      data-en="BTM N2 roles embedded in France, leveraging the shared service factory to deliver technical transformation and advanced solution set-up."
                      data-fr="R√¥les BTM N2 ancr√©s en France, s‚Äôappuyant sur l‚Äôusine mutualis√©e pour d√©livrer la transformation technique et le set-up avanc√© des solutions.">
                      BTM N2 roles embedded in France, leveraging the shared service factory to deliver technical transformation and advanced solution set-up.
                    </p>
                    <div class="org-divider-label org-i18n" data-en="BTM France (N2)" data-fr="BTM France (N2)">BTM France (N2)</div>
                    <div class="org-sub-block">
                      <div class="org-line-title org-i18n" data-en="N2 BTM Capacity" data-fr="Capacit√© BTM N2">N2 BTM Capacity</div>
                      <p class="org-i18n"
                        data-en="Local BTM France roles connected to the shared N2 pool managed under Naoual‚Äôs shared service."
                        data-fr="R√¥les BTM France locaux connect√©s √† la ‚Äúpool‚Äù N2 mutualis√©e pilot√©e par le Shared Service de Naoual.">
                        Local BTM France roles connected to the shared N2 pool managed under Naoual‚Äôs shared service.
                      </p>
                      <div class="org-kpi-row">
                        <div class="org-kpi">
                          <div class="org-kpi-label org-i18n" data-en="BTM roles" data-fr="R√¥les BTM">BTM roles</div>
                          <div class="org-kpi-value org-i18n" data-en="BTM (1), BTM (2)" data-fr="BTM (1), BTM (2)">BTM (1), BTM (2)</div>
                        </div>
                        <div class="org-kpi">
                          <div class="org-kpi-label org-i18n" data-en="Extra capacity" data-fr="Capacit√© additionnelle">Extra capacity</div>
                          <div class="org-kpi-value org-i18n" data-en="From N2 shared pool (~12)" data-fr="Depuis la pool N2 mutualis√©e (~12)">From N2 shared pool (~12)</div>
                        </div>
                      </div>
                    </div>
                  </div>
                </section>
              </div>
              <div class="org-connector-row">
                <div class="org-connector-label org-i18n"
                  data-en="France COE taps into the regional backbone (Edouard, Naoual, Tiburce) for priority setting and execution."
                  data-fr="Le COE France s‚Äôappuie sur le socle r√©gional (Edouard, Naoual, Tiburce) pour la priorisation et l‚Äôex√©cution.">
                  France COE taps into the regional backbone (Edouard, Naoual, Tiburce) for priority setting and execution.
                </div>
              </div>
            </div>

            <div class="org-step" data-step="2" role="tabpanel">
              <div class="org-grid">
                <section class="org-card card-maghreb">
                  <div class="org-card-header">
                    <div class="org-card-title org-i18n"
                      data-en="Maghreb COE ‚Äì Chefs de Projet &amp; N1"
                      data-fr="COE Maghreb ‚Äì Chefs de Projet &amp; N1">
                      Maghreb COE ‚Äì Chefs de Projet &amp; N1
                    </div>
                    <span class="org-tag tag-maghreb org-i18n"
                      data-en="COE Maghreb (N1 only)"
                      data-fr="COE Maghreb (N1 uniquement)">
                      COE Maghreb (N1 only)
                    </span>
                  </div>
                  <div class="org-card-body">
                    <p class="org-i18n"
                      data-en="Local innovation leads for each Maghreb site to drive project execution, backed by N1 support."
                      data-fr="Leads innovation locaux pour chaque site Maghreb, accompagn√©s du support N1.">
                      Local innovation leads for each Maghreb site to drive project execution, backed by N1 support.
                    </p>
                    <div class="org-divider-label org-i18n" data-en="Maghreb Sites" data-fr="Sites Maghreb">Maghreb Sites</div>
                    <div class="org-local-grid">
                      <div class="org-local-col">
                        <div class="org-local-title org-i18n" data-en="C&amp;S (Rabat / F√®s / Mekn√®s)" data-fr="C&amp;S (Rabat / F√®s / Mekn√®s)">C&amp;S (Rabat / F√®s / Mekn√®s)</div>
                        <div class="org-local-item">
                          <div class="org-local-role org-i18n" data-en="Chef de Projet: Jalal Benslimane (Rabat)" data-fr="Chef de Projet&nbsp;: Jalal Benslimane (Rabat)">Chef de Projet: Jalal Benslimane (Rabat)</div>
                          <div class="org-local-n1 org-i18n" data-en="N1: Amine El Ghandouri (Rabat)" data-fr="N1&nbsp;: Amine El Ghandouri (Rabat)">N1: Amine El Ghandouri (Rabat)</div>
                          <div class="org-local-n1 org-i18n" data-en="N1: Achraf Elmaslouhi (Mekn√®s)" data-fr="N1&nbsp;: Achraf Elmaslouhi (Mekn√®s)">N1: Achraf Elmaslouhi (Mekn√®s)</div>
                          <div class="org-local-n1 org-i18n" data-en="N1: To be defined (F√®s)" data-fr="N1&nbsp;: √Ä d√©finir (F√®s)">N1: To be defined (F√®s)</div>
                        </div>
                      </div>

                      <div>
                        <div class="org-local-title org-i18n" data-en="AT Region (Algeria / Tunisia)" data-fr="R√©gion AT (Alg√©rie / Tunisie)">AT Region (Algeria / Tunisia)</div>
                        <div class="org-local-item">
                          <div class="org-local-role org-i18n" data-en="Chef de Projet: To be defined (AT)" data-fr="Chef de Projet&nbsp;: √Ä d√©finir (AT)">Chef de Projet: To be defined (AT)</div>
                          <div class="org-local-n1 org-i18n" data-en="N1: Rahma Ezzine (Tunisia)" data-fr="N1&nbsp;: Rahma Ezzine (Tunisie)">N1: Rahma Ezzine (Tunisia)</div>
                          <div class="org-badge-open">
                            <span class="org-badge-open-dot"></span>
                            <span class="org-i18n"
                              data-en="N1: To be defined (Algeria)"
                              data-fr="N1&nbsp;: √Ä d√©finir (Alg√©rie)">
                              N1: To be defined (Algeria)
                            </span>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </section>
              </div>
              <div class="org-connector-row">
                <div class="org-connector-label org-i18n"
                  data-en="Maghreb COE executes locally while staying aligned with the shared backbone and France COE practices."
                  data-fr="Le COE Maghreb ex√©cute localement tout en restant align√© sur le socle partag√© et les pratiques du COE France.">
                  Maghreb COE executes locally while staying aligned with the shared backbone and France COE practices.
                </div>
              </div>
            </div>
          </div>

          <div class="org-flow-controls" aria-live="polite">
            <span class="org-step-counter">Step 1 of 3</span>
            <div class="org-flow-actions">
              <button class="org-flow-prev" type="button">‚Üê Previous</button>
              <button class="org-flow-next" type="button">Next ‚Üí</button>
            </div>
          </div>
        </div>
      </section>

      <section class="slide" data-title="Regional Operating Model">
        <div class="section-title"><span>+</span>Regional Operating Model</div>
        <div class="content-grid">
          <div class="card">
            <h3>France &amp; Maghreb COE</h3>
            <p>
              Explore a bilingual, zoomable operating model covering the functional core, shared service factory,
              regional delivery drive, and local COE execution across France &amp; Maghreb.
            </p>
            <ul>
              <li>Toggle EN/FR content instantly.</li>
              <li>Click any card to open a detailed overlay and navigate with arrows.</li>
              <li>Highlight roles, headcount and site coverage for N1/N2 teams.</li>
            </ul>
            <button class="cta-button regional-open" type="button">Open in-page view</button>
          </div>
        </div>
      </section>

      <section class="slide" data-title="C. Scorecard">
        <div class="section-title"><span>C</span>Scorecard</div>
        <div class="pillars">
          <div class="card">
            <h3>Implementation & Adoption</h3>
            <p>TODO: KPIs tracking delivery, rollout, and adoption metrics.</p>
            <div class="kpi" style="--value: 70%;">
              <div class="bar"></div>
              <p>Sample KPI: Delivery Readiness 70%</p>
            </div>
          </div>
          <div class="card">
            <h3>Client Engagement & Pipeline</h3>
            <p>TODO: KPIs for client pipeline, engagement score, and deal velocity.</p>
            <div class="kpi" style="--value: 55%;">
              <div class="bar"></div>
              <p>Sample KPI: Active Pipeline 55%</p>
            </div>
          </div>
          <div class="card">
            <h3>TekLab & Change Management</h3>
            <p>TODO: KPIs linked to events, training, and change adoption.</p>
            <div class="kpi" style="--value: 80%;">
              <div class="bar"></div>
              <p>Sample KPI: Training Completion 80%</p>
            </div>
          </div>
        </div>
      </section>

      <section class="slide" data-title="D. TekLab & Change Management">
        <div class="section-title"><span>D</span>TekLab & Change Management</div>
        <div class="content-grid">
          <div class="card">
            <h3>Events & Visits</h3>
            <p>TODO: Summaries of TekLab events, partner visits, and immersive demos.</p>
          </div>
          <div class="card">
            <h3>Training</h3>
            <p>TODO: Highlight training programs, enablement sessions, and attendee stats.</p>
          </div>
          <div class="card">
            <h3>Hackathons</h3>
            <p>TODO: Spotlight on hackathon themes, participation, and prototypes.</p>
          </div>
          <div class="card">
            <h3>Process Modernization</h3>
            <p>TODO: HR, tooling, and operational improvements driven by change initiatives.</p>
          </div>
        </div>
      </section>

      <section class="slide" data-title="E. Success Stories">
        <div class="section-title"><span>E</span>Success Stories</div>
        <div class="content-grid">
          <div class="card">
            <h3>Client Win #1</h3>
            <p>TODO: Describe the challenge, solution, and measurable impact.</p>
          </div>
          <div class="card">
            <h3>Client Win #2</h3>
            <p>TODO: Share story of innovation and business outcome.</p>
          </div>
          <div class="card">
            <h3>Client Win #3</h3>
            <p>TODO: Highlight efficiency gains, customer satisfaction, or revenue growth.</p>
          </div>
        </div>
      </section>

      <section class="slide" data-title="F. IX Products">
        <div class="section-title"><span>F</span>IX Products</div>
        <div class="content-grid">
          <div class="card">
            <h3>Product Pipeline</h3>
            <p>TODO: List products in discovery, build, and launch phases.</p>
          </div>
          <div class="card">
            <h3>Roadmap</h3>
            <p>TODO: Quarter-by-quarter view of upcoming releases and milestones.</p>
          </div>
          <div class="card">
            <h3>Impact</h3>
            <p>TODO: Summaries of business value, adoption metrics, and feedback.</p>
          </div>
        </div>
      </section>
    </div>
  </main>

  <div class="modal-backdrop" id="regionalOverlay" hidden>
    <div class="modal-surface" role="dialog" aria-modal="true" aria-labelledby="regionalOverlayTitle">
      <div class="modal-toolbar">
        <h3 class="modal-title" id="regionalOverlayTitle">
          <span>+</span>
          Regional Operating Model
        </h3>
        <button class="modal-close" type="button" id="regionalClose">
          <span aria-hidden="true">‚úï</span>
          <span>Close</span>
        </button>
      </div>
      <iframe
        class="modal-frame"
        id="regionalFrame"
        title="Regional Operating Model"
        src="regional-model.html"
        loading="eager"
      ></iframe>
    </div>
  </div>

  <script>
    // Presentation setup
    const slidesContainer = document.getElementById('slides');
    let slides = Array.from(document.querySelectorAll('.slide'));
    const topNav = document.getElementById('topNav');
    const reorderList = document.getElementById('reorderList');
    const navButtonMap = new Map();
    const regionalOverlay = document.getElementById('regionalOverlay');
    const regionalFrame = document.getElementById('regionalFrame');
    const regionalOpen = document.querySelector('.regional-open');
    const regionalClose = document.getElementById('regionalClose');
    let navObserver;

    const openRegionalOverlay = () => {
      if (!regionalOverlay) return;
      regionalOverlay.hidden = false;
      regionalOverlay.classList.add('open');
      document.body.style.overflow = 'hidden';
    };

    const closeRegionalOverlay = () => {
      if (!regionalOverlay) return;
      regionalOverlay.classList.remove('open');
      regionalOverlay.hidden = true;
      document.body.style.overflow = '';
    };

    const ensureSlideIds = () => {
      slides.forEach((slide, index) => {
        if (!slide.id) {
          slide.id = `slide-${index + 1}`;
        }
      });
    };

    /**
     * Lightweight internationalization for the Organization COE card.
     */
    function initOrgLangToggle() {
      const orgScope = document.querySelector('.org-scope');
      if (!orgScope) return;

      const texts = orgScope.querySelectorAll('.org-i18n');
      const buttons = orgScope.querySelectorAll('.org-lang-btn');
      let currentOrgLang = 'en';

      const applyLang = (lang) => {
        texts.forEach((el) => {
          const value = el.getAttribute(`data-${lang}`);
          if (value !== null) {
            el.innerHTML = value;
          }
        });

        buttons.forEach((btn) => {
          btn.classList.toggle('active', btn.dataset.lang === lang);
        });

        document.documentElement.setAttribute('lang', lang === 'fr' ? 'fr' : 'en');
        currentOrgLang = lang;
      };

      buttons.forEach((btn) => {
        btn.addEventListener('click', () => {
          const lang = btn.dataset.lang;
          if (lang && lang !== currentOrgLang) {
            applyLang(lang);
          }
        });
      });

      applyLang(currentOrgLang);
    }

    /**
     * Guided navigation for the Organization COE content so only one block shows at a time.
     */
    function initOrgStepper() {
      const orgScope = document.querySelector('.org-scope');
      if (!orgScope) return;

      const steps = Array.from(orgScope.querySelectorAll('.org-step'));
      const buttons = Array.from(orgScope.querySelectorAll('.org-step-btn'));
      const prev = orgScope.querySelector('.org-flow-prev');
      const next = orgScope.querySelector('.org-flow-next');
      const counter = orgScope.querySelector('.org-step-counter');
      let active = 0;

      const update = () => {
        steps.forEach((step, idx) => {
          const isActive = idx === active;
          step.classList.toggle('active', isActive);
          step.setAttribute('aria-hidden', String(!isActive));
        });

        buttons.forEach((btn, idx) => {
          const isActive = idx === active;
          btn.classList.toggle('active', isActive);
          btn.setAttribute('aria-selected', String(isActive));
        });

        if (prev) prev.disabled = active === 0;
        if (next) next.disabled = active === steps.length - 1;
        if (counter) counter.textContent = `Step ${active + 1} of ${steps.length}`;
      };

      const goTo = (idx) => {
        active = Math.max(0, Math.min(idx, steps.length - 1));
        update();
      };

      buttons.forEach((btn, idx) => btn.addEventListener('click', () => goTo(idx)));
      if (prev) prev.addEventListener('click', () => goTo(active - 1));
      if (next) next.addEventListener('click', () => goTo(active + 1));

      goTo(0);
    }

    function initRegionalOverlay() {
      if (!regionalOverlay || !regionalFrame || !regionalOpen || !regionalClose) return;

      regionalOpen.addEventListener('click', () => {
        // Frame loads eagerly but guard against stripped src attributes.
        if (!regionalFrame.getAttribute('src')) {
          regionalFrame.setAttribute('src', 'regional-model.html');
        }
        openRegionalOverlay();
      });

      regionalClose.addEventListener('click', closeRegionalOverlay);

      regionalOverlay.addEventListener('click', (event) => {
        if (event.target === regionalOverlay) {
          closeRegionalOverlay();
        }
      });

      document.addEventListener('keydown', (event) => {
        if (event.key === 'Escape' && regionalOverlay.classList.contains('open')) {
          closeRegionalOverlay();
        }
      });
    }

    /**
     * Build navigation buttons for the top bar based on slides.
     * Keeps the HTML lean and makes it easy to update slide count.
     */
    function buildNavigation() {
      if (!topNav) return;

      topNav.innerHTML = '';
      navButtonMap.clear();
      ensureSlideIds();

      slides.forEach((slide, index) => {
        const title = slide.dataset.title || `Slide ${index + 1}`;

        const btn = document.createElement('button');
        btn.textContent = title;
        btn.addEventListener('click', () => {
          slide.scrollIntoView({ behavior: 'smooth', block: 'start' });
        });

        topNav.appendChild(btn);
        navButtonMap.set(slide.id, btn);
      });

      const firstSlideId = slides[0]?.id;
      if (firstSlideId && navButtonMap.has(firstSlideId)) {
        navButtonMap.get(firstSlideId).classList.add('active');
      }
    }

    /**
     * Highlight the current section button based on scroll position.
     */
    function initNavHighlight() {
      if (!navButtonMap.size) return;

      if (navObserver) {
        navObserver.disconnect();
      }

      navObserver = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            const btn = navButtonMap.get(entry.target.id);
            if (!btn) return;

            if (entry.isIntersecting) {
              navButtonMap.forEach((button) => button.classList.remove('active'));
              btn.classList.add('active');
            }
          });
        },
        { threshold: 0.55 }
      );

      slides.forEach((slide) => navObserver.observe(slide));
    }

    /**
     * Drag-and-drop helper to find the element after the cursor.
     */
    function getDragAfterElement(container, y) {
      const draggableElements = [...container.querySelectorAll('.reorder-item:not(.dragging)')];

      return draggableElements.reduce(
        (closest, child) => {
          const box = child.getBoundingClientRect();
          const offset = y - box.top - box.height / 2;
          if (offset < 0 && offset > closest.offset) {
            return { offset, element: child };
          }
          return closest;
        },
        { offset: Number.NEGATIVE_INFINITY, element: null }
      ).element;
    }

    function updateReorderBadges() {
      if (!reorderList) return;
      reorderList.querySelectorAll('.reorder-item').forEach((item, idx) => {
        const badge = item.querySelector('.reorder-badge');
        if (badge) {
          badge.textContent = `#${idx + 1}`;
        }
      });
    }

    function applyReorderFromList() {
      if (!reorderList || !slidesContainer) return;

      reorderList.querySelectorAll('.reorder-item').forEach((item) => {
        const slideId = item.dataset.slideId;
        const slide = slideId ? document.getElementById(slideId) : null;
        if (slide) {
          slidesContainer.appendChild(slide);
        }
      });

      slides = Array.from(slidesContainer.querySelectorAll('.slide'));
      updateReorderBadges();
      buildNavigation();
      initNavHighlight();
    }

    function buildReorderList() {
      if (!reorderList) return;

      reorderList.innerHTML = '';
      ensureSlideIds();

      slides.forEach((slide) => {
        const item = document.createElement('li');
        item.className = 'reorder-item';
        item.draggable = true;
        item.dataset.slideId = slide.id;

        const handle = document.createElement('span');
        handle.className = 'reorder-handle';
        handle.textContent = '‚â°';
        handle.setAttribute('aria-hidden', 'true');

        const label = document.createElement('span');
        label.className = 'reorder-label';
        label.textContent = slide.dataset.title || slide.id;

        const badge = document.createElement('span');
        badge.className = 'reorder-badge';

        item.appendChild(handle);
        item.appendChild(label);
        item.appendChild(badge);

        item.addEventListener('dragstart', (event) => {
          item.classList.add('dragging');
          if (event.dataTransfer) {
            event.dataTransfer.effectAllowed = 'move';
            event.dataTransfer.setData('text/plain', slide.id);
          }
        });

        item.addEventListener('dragend', () => {
          item.classList.remove('dragging');
          applyReorderFromList();
        });

        reorderList.appendChild(item);
      });

      reorderList.addEventListener('dragover', (event) => {
        event.preventDefault();
        const afterElement = getDragAfterElement(reorderList, event.clientY);
        const dragging = reorderList.querySelector('.reorder-item.dragging');
        if (!dragging) return;
        if (afterElement == null) {
          reorderList.appendChild(dragging);
        } else {
          reorderList.insertBefore(dragging, afterElement);
        }
        updateReorderBadges();
      });

      updateReorderBadges();
    }

    // Initialize presentation behavior
    ensureSlideIds();
    buildNavigation();
    initNavHighlight();
    buildReorderList();
    initOrgLangToggle();
    initOrgStepper();
    initRegionalOverlay();
  </script>
</body>
</html>
